---
title: "Portfolio 1 â€” Experimental Methods 1 2019"
author: "Anne-Line Thomsen"
date: "x/x/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, include = TRUE)
```

## Portfolio exam - Part 1

#### Write a short data mining report on the CogSci Intro Week Personality Test Data in which you answer the following questions in prose, code and graphs:

First of all, you have to import the personality data. If the dataset is in your working directory, then you can just load it into R. Otherwise you will have to change your working directory.

```{r load_data}
Full_personality_data <- read.csv("NEW_CogSciPersonalityTest2019 (1).csv")
```

```{r setting working directory}
setwd("/Users/anne-linethomsen/Documents/R/ExperimentalMethods/PersonalityTest/PersonalityTest")
```

```{r loading packages}
library(tidyverse)
```

Once you are done loading the data, you can start working on the questions below.

#### Question 1

Who can hold their breath longer on average, those with right or left ocular dominance? Plot the data using ggplot2 to find out. The plots should include error bars (depicting the standard error of the means). Then use the mean() and sd() functions to find mean and standard deviation of the two eye dominance groups.

I make a new dataframe with only right and left.

```{r question1}
Data_ocular_rl <- filter(Full_personality_data, Full_personality_data$ocular_dom == "Right" | Full_personality_data$ocular_dom == "Left")
```

I try to make the ggplot

```{r question1, echo=TRUE}
ggplot(Data_ocular_rl, aes(x=ocular_dom, y=breath_hold, fill = ocular_dom)) + 
  geom_bar(stat="summary", fun.y = mean, width = 0.5) +
  geom_errorbar(stat = 'summary', fun.data = mean_se, width = 0.2)+
  labs(x = "Dominant ocular", y = "Mean breath hold") +
  scale_fill_hue(l=50)
```

I try to do this table thing:

```{r}
summary_breath_hold_by_ocular <- Data_ocular_rl %>%
  group_by(ocular_dom) %>%
  summarise(mean(breath_hold), sd(breath_hold))
```

Explain your results in plain terms here: 

---

#### Question 2

Who likes silence vs. noise best? Males or females? Also in this case you should plot the data using ggplot2 (including error bars), then use the mean() and sd() functions to find mean and standard deviation of the two genders.

I make a ggplot

```{r}
ggplot(Full_personality_data, aes(x = gender, y = sound_level_pref, fill = gender)) + 
  geom_bar(stat = 'summary', fun.y = mean, width = 0.5) +
  geom_errorbar(stat = 'summary', fun.data =  mean_se, width = 0.2) +
  labs(x = "Gender", y = "Mean preferred sound level") + 
  scale_fill_hue(l=50)
```

finding mean and sd for each gender
```{r}
summary_preferred_sound_level <- Full_personality_data %>%
  group_by(gender) %>%
  summarise(mean(sound_level_pref), sd(sound_level_pref))
```

Explain your results in plain terms here: 

---

#### Question 3

Are the breath_hold data normally distributed? Provide visual and numeric support for your answer.

I start out making a frequency map (?) to see what the graph looks like and add a line that shows the standard deviation. 
```{r question3}
ggplot(Full_personality_data, aes(x=breath_hold)) + geom_histogram(aes(y = ..density..), colour = "black", fill = "white") + stat_function(fun = dnorm, args = list(mean = mean(Full_personality_data$breath_hold), sd = sd(Full_personality_data$breath_hold)), colour = "red", size = 1)
```
#What does ...density... do??
#What does the args = list do???

Next I make a qq-plot of my data:

```{r making qq-plot}
qplot(sample = Full_personality_data$breath_hold) + labs(x="Expected values", y="Observed value")
```

#How do I add the straight line with the ideal normal distribution?

I install the package:

```{r include=FALSE}
install.packages("pastecs")
```

Now I try to make a test on the data:

```{r}
round(pastecs::stat.desc(cbind(Full_personality_data$breath_hold), basic = FALSE, norm = TRUE), digits = 2)
```

This gives me following values:
skew.2SE = 0.95
kurt.2SE = -0.30
normtest.p = 0.04

Since the skew has to be under 1, and the kurtosis as close to 0 as possible, and the Shairo-Wilk test has to be under the trehshold of 0.05, I would say this distribution is normal even though the p-value is under 0.05, cause it's very close to 0.05. (??)
#Aren't these results a bit contradicting??


Explain your results in plain terms here: 

---

#### Question 4

Are the Balloon reaction time data (balloon and balloon_balance) normally distributed? Provide visual and numeric support for your answer.

# Would you check for outliers as the first thing?

Start out with the numeric data for balloon
```{r question4}
round(pastecs::stat.desc(Full_personality_data$balloon, basic = FALSE, norm = TRUE), digits = 2)
```

I get following results:
skew.2SE = 3.31
kurt.2SE = 2.38
Normtest.p = 0.00

The skew is way over 1, kurtosis far from 0, p-value under 0.05 = non-significant (?) at least not normally distributed. 

I do the same to the balloon_balance data:
```{r}
round(pastecs::stat.desc(Full_personality_data$balloon_balance, basic = FALSE, norm = TRUE), digits = 2)
```

skew.2SE = 2.02
kurt.2SE = -0.25
Normtest.p = 0.00

The skew is over 1, but the kurt is a bit close to 0, but the p-value is 0, so this indicates that the test i not normally distributed.


Now I want to do the visual part for balloon:
```{r}
ggplot(Full_personality_data, aes(x = balloon)) + geom_histogram(aes(y = ..density..), binwidth = 0.25, color = "black", fill = "white") + ggtitle("Distribution of balloon data") + stat_function(fun = dnorm, args = list(mean = mean(Full_personality_data$balloon, na.rm = TRUE), sd = sd(Full_personality_data$balloon, na.rm = TRUE)), colour= "red", size = 1)
```

At the graph I notice there is an outlier, so to get rid of it, I remove all data, that has a value bigger than the mean + 3*sd:
```{r}
Full_personality_data$balloon_zscores <- ((Full_personality_data$balloon - mean(Full_personality_data$balloon)) / sd(Full_personality_data$balloon))

Balloon_filtered <- filter(Full_personality_data, Full_personality_data$balloon_zscores < 3 & Full_personality_data$balloon_zscores > -3)
```

I try to run the exact same code for the ggplot, to see if the outliers has been sorted out:
```{r}
ggplot(Balloon_filtered, aes(x = balloon)) + geom_histogram(aes(y = ..density..), binwidth = 0.25, color = "black", fill = "white") + ggtitle("Distribution of balloon data") + stat_function(fun = dnorm, args = list(mean = mean(Balloon_filtered$balloon, na.rm = TRUE), sd = sd(Balloon_filtered$balloon, na.rm = TRUE)), colour= "red", size = 1)
```

It seems like the outlier on the graph is actually not considered as an outlier? According to the mean+3*sd...?


Explain your results in plain terms here: 

---

#### Question 5

Shoe size could tell us something about general body size, which could also be connected to one's ability to hold your breath. In other words we predict that there is a positive relation between shoe size and how long time CogSci students can hold their breath. Try plotting the two sets of data against each other using a scatter plot (hint: both variables are continuous variables). Bonus question: Males and females have different body sizes. Use grouping in your plot to distinguish the relationship between shoe size and holding breath for males and females.

At first I just make a simple scatterplot, and it's a bit messy...
```{r question5}
ggplot(Full_personality_data, aes(x = shoesize, y = breath_hold)) + geom_point() + geom_smooth()
```

I try to group it by gender:
```{r}
Grouped_data <- Full_personality_data
  group_by(Grouped_data$gender)
```

I try to see the new scatterplot:
```{r}
ggplot(Grouped_data, aes(x = shoesize, y = breath_hold)) + geom_point()
```

Explain your results in plain terms here: 


